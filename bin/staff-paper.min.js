/*! Staff Paper - v0.1.0 - 2012-11-10
* Copyright (c) 2012 Eric Rubio; Licensed MIT */
var StaffPaper;window.StaffPaper=StaffPaper,function(){StaffPaper=function(e,t,n){n||(n={}),this.options=n,this.options.lineSpacing=parseInt(n.lineSpacing,10)||20,this.options.noteSpacing=parseInt(n.noteSpacing,10)||10,this.options.padding=parseInt(n.padding,10)||40,this.container_id=e,this.width=parseInt(t,10),this.height=this.options.lineSpacing*4+this.options.padding*2,this.staves=[],this.ui={},this.paper=new Raphael(this.container_id,this.width,this.height),this.noteYMap={},this.noteYMap[1]={f:this.options.padding,e:this.options.padding+this.options.lineSpacing*.5,d:this.options.padding+this.options.lineSpacing,c:this.options.padding+this.options.lineSpacing*1.5},this.noteYMap[0]={b:this.options.padding+this.options.lineSpacing*2,a:this.options.padding+this.options.lineSpacing*2.5,g:this.options.padding+this.options.lineSpacing*3,f:this.options.padding+this.options.lineSpacing*3.5,e:this.options.padding+this.options.lineSpacing*4,d:this.options.padding+this.options.lineSpacing*4.5,c:this.options.padding+this.options.lineSpacing*5}},StaffPaper.prototype.addNote=function(e,t,n){if(this.staves[e]===undefined)throw new Error("Staff ["+e+"] does not exist.");var r=StaffPaper.getNoteInfo(this.staves[e],t),i=parseInt(n,10)||4;this.staves[e].notes.push(new StaffPaper.Note(r.name,i,r.octave))},StaffPaper.prototype.addStaff=function(e,t){var n=new StaffPaper.Staff(e,t);return this.staves.push(n),n},StaffPaper.prototype.getYPosForNote=function(e,t){return this.noteYMap[t][e.toLowerCase()]},StaffPaper.prototype.draw=function(){var e="";for(var t=0,n=this.options.padding;t<5;t++,n+=this.options.lineSpacing)e+="M0 "+n.toString()+"L"+this.width+" "+n.toString();this.ui.bg=this.paper.rect(0,0,this.width,this.height,4).attr({fill:"#efefef",stroke:"none"})},StaffPaper.prototype.clear=function(){this.staves=[],this.ui={},this.paper.clear()},StaffPaper.Note=function(e,t,n){this.name=e||"",this.duration=parseInt(t,10)||4,this.octave=n},StaffPaper.Staff=function(e,t){this.clef=e||"",this.notes=[];var n=parseInt(t,10)||0;this.clef==="g"?this.octave=4+n:this.clef==="f"&&(this.octave=3+n)},StaffPaper.Staff.prototype.addNote=function(e,t){var n=StaffPaper.getNoteInfo(this,e),r=parseInt(t,10)||4;this.notes.push(new StaffPaper.Note(n.name,r,n.octave))},StaffPaper.getNoteInfo=function(e,t){var n="",r=e.octave;if(e.clef==="g"){t<=-4?r=6:t>=-3&&t<=3?r=5:t>=11&&(r=3);switch(t){case-6:n="E";break;case-5:n="D";break;case-4:n="C";break;case-3:n="B";break;case-2:n="A";break;case-1:n="G";break;case 0:n="F";break;case 1:n="E";break;case 2:n="D";break;case 3:n="C";break;case 4:n="B";break;case 5:n="A";break;case 6:n="G";break;case 7:n="F";break;case 8:n="E";break;case 9:n="D";break;case 10:n="C";break;case 11:n="B";break;case 12:n="A"}}else e.clef==="f";return{name:n,octave:r}}}(StaffPaper);